<!--
title: 形式化安全分析工具
subtitle: 工业安全
author: 卜绪萌
keyword: 工业安全
published: 2024-04-26
topicImg: assets/3/ASD9.png
-->

# 形式化安全分析工具
本文将介绍两种形式化安全分析工具 Scyther 和 ProVerif，这两种工具用于分析安全协议。安全协议的载体为网络通信环境，在该环境下两个或两个以上通信实体为达成某种目的而采用密码学原语进行沟通的一系列交互就称为安全协议。安全协议囊括四种功能，分别是认证、密钥协商、隐私保护和数据共享，这四种主要功能的实现能够达成网络协议的安全目标，本论文的安全协议将围绕这些功能进行设计。

##一、Scyther
Scyther 是一种形式化安全协议分析工具，利用该工具可以分析安全协议是否满足机密性、身份验证、（弱）完美的前向保密、抗密钥泄露、抗重放攻击等安全属性。其安全分析能力基于 Dolev-Yao 模型和强安全敌手模型，Dolev-Yao 分析黑盒安全协议并构建该模型，模型中具有明确的假设和明确定义的安全属性。黑盒安全协议包含三重抽象概念，第一，密码学被认为是完美的，只有手持密钥的人才能解密密文；第二，消息被认为是抽象的术语，要么对手利用密钥得到完整的消息，要么他什么也没得到；第三，网络处于对手的完全控制之下，对手可以窃听、篡改、删除信道中任何消息。强安全敌手模型的攻击参数中可以添加随机数泄露、状态空间泄露、会话密钥泄露等。Scyther 模型是一个定义安全协议及其行为的模型，是一个基于角色的安全协议模型，它与并发协议的数量无关。该模型明确地给出了协议分析的几个假设，并允许从协议描述中推导出对手的知识。在协议模型中，安全属性被建模为本地断言事件

Scyther 语句类似 C/java 语言，如图所示，程序的编写需要两个模块，分别是密码学原语的声明和各角色计算与通信的描述。密码学原语的声明中指出协议中包含的函数类型、全局变量和宏定义。各角色中的描述依照安全协议的顺序执行，安全协议中涉及的密码学原语已声明，协议主要利用一对 send 和 recv 功能表示消息的发送和接收，协议末尾需添加所分析的安全属性，输出的分析结果与这些属性一一对应，若满足则结果 Status 为“OK”，否则为“Fail”。

![img_26.png](assets/3/img_26.png)

安全属性中常用的有机密性（Secret）、活性（Alive）、非单射同步性（Non-injective synchronization，Nisynch）、非单射一致性（Non-injective agree，Niagree）和弱一致性（Weakagree）。

Secret 表示值的机密性，即某些信息不会泄露给对手。

Alive 表示消息应该满足活性，用以确定预期的通信对方已执行某些事件，即“活着”，即便通信对方不在意消息的响应。

Nisynch 要求确定所有接收到的消息由通信对方发送，并且发送的消息确定由通信对方接收，确保指定的协议行为即使在有对手的情况下也会发生，即 Nisynch 要求必须按照预期的顺序执行相应的发送和接收消息。

Niagree 表示协议双方必须对收到的消息做出回应，Niagree 的定义与 Nisynch 类似，唯一区别在于 Niagree 无需遵守通信顺序。

Weakagree 表示若通信主体 A 认定与 B 运行了协议，则 A 也认为 B 也与 A 运行了这次协议。

如下表所示为 Scyther 语法定义。迄今为止，Scyther 已顺利应用到多项密码协议的安全性分析中。

![img_27.png](assets/3/img_27.png)

下图为某协议经过Scyther验证成功后的案例

![img_28.png](assets/3/img_28.png)

##二、ProVerif
ProVerif 是一种自动证明密码协议安全性的形式化验证工具，能够提供对对称加密、非对称加密、非交互式零知识证明、数字签名、hash 函数以及比特承诺等多种密码学原语的支持。为检验协议中应具备机密性和身份验证的安全属性，ProVerif 能够证明协议可达性、对应断言和观察等价性。不仅如此，还可分析通信协议中的身份隐私、可追溯性和可验证性等安全属性。在无限的会话数量和消息空间中，该工具还能够发起重构攻击并检验协议的以上属性是否安全。当难以证明某个属性时，ProVerif会试图重构伪造所需属性的执行跟踪。该工具的分析能力是基于 Dolev-Yao 模型而形成的，在此模型下，攻击者作为正常通信的网络用户，通常可以发起和接收与网络服务器和其他用户的会话，也可冒充其他实体向外发送信息。然而，由于网络实体自行选取的随机数和密钥等秘密值是机密存储的，攻击者无法窃取此类信息或攻破存储信息的服务器。因此密码协议的安全性完全依托于各种密码学操作，才能避免攻击者对消息的窃听、篡改、注入和清除导致的不良后果。

ProVerif 的输入语句包括应用 pi 演算或 Horn 字句，应用 pi 演算是最为常见的语句，它的存在是为了支撑在信道（如 Internet）中并发进程的交互。如图所示，协议的 ProVerif 模型，用工具的输入语言编写，可以分为密码原语的声明、子进程和主进程三部分。密码原语的声明中，包含多个不可或缺的密码原语，如公共信道 channel、变量类型 type、变量 variable、函数 function、事件 event 以及询问 query 等。用户根据自身需要构建自定义的函数等式，这些函数等式类型皆为 function，且采用 event 描述某个事件，而 query 作为查询则分析了协议的安全性。每个通信实体都有自己独立的子进程，子进程中描述该通信实体在此协议中的所有操作，此时需调用已声明的密码原语。作为最后且最重要的部分，主进程联系所有子进程并使密码协议正常运行。对每条 query 都会输出相应的结果，当该条 Query 安全，结果为 RESULT [Query] is true；当该条 Query 不安全即某项安全属性会受到攻击，结果为 RESULT [Query] is false；当协议中的语句无法证明该条 Query 是否安全，则结果为 RESULT [Query] cannot be proved。

![img_29.png](assets/3/img_29.png)

协议中语法定义如下表所示。迄今为止，ProVerif 已应用到多项密码协议的安全性分析中。

![img_30.png](assets/3/img_30.png)
![img_31.png](assets/3/img_31.png)

注：内容来自https://kns.cnki.net/kcms2/article/abstract?v=vRpkk4QO0oi3y6m-lApVXMuNUHB5mTn_rZqoR6K7131u9TaW2v92xbbqW4DVXSqL1OlhA6t7rM0yHO9aeGFTTLLHK18Vw_YGAzw94CNPKotthFOelzrBnnBVVZwjYJ6t-4OX1wHqVS688oCFx1dGdg==&uniplatform=NZKPT&language=CHS